import"./style-BD-upOib.js";import{P as N,S as k,C as B,W as F,B as U,b as E,c as G,d as W,A as $,O as q,V as H,e as J,T as C,M as K,f as Q,_ as p}from"./OrbitControls-BbRSWhb2.js";const X=Object.assign({"../images/Textures/Default/Earth.png":()=>p(()=>import("./Earth-DGjz-tJ9.js"),[]),"../images/Textures/Default/Fin.png":()=>p(()=>import("./Fin-CnkssCPZ.js"),[]),"../images/Textures/Default/Jupiter.png":()=>p(()=>import("./Jupiter-Btm3qV2T.js"),[]),"../images/Textures/Default/Mars.png":()=>p(()=>import("./Mars-YzExCoEH.js"),[]),"../images/Textures/Default/Mercury.png":()=>p(()=>import("./Mercury-DZme_3wn.js"),[]),"../images/Textures/Default/Neptune.png":()=>p(()=>import("./Neptune-syUdH9Uc.js"),[]),"../images/Textures/Default/Saturn.png":()=>p(()=>import("./Saturn-Byl8iaty.js"),[]),"../images/Textures/Default/The Sun.png":()=>p(()=>import("./The Sun-CPRKx_61.js"),[]),"../images/Textures/Default/Uranus.png":()=>p(()=>import("./Uranus-BoEjMazO.js"),[]),"../images/Textures/Default/Venus.png":()=>p(()=>import("./Venus-HjHypM1x.js"),[])}),T=149597870700,w=20;let x,u,_,g,P,b,L={},M=[],S=0,A=!0;function Y(){Z()}function Z(){const t=window.innerWidth*.8/window.innerHeight;x=new N(60,t,.1,5e3),x.position.z=50,_=new k,_.background=new B(0),ee(),g=new F({antialias:!0}),g.setPixelRatio(window.devicePixelRatio),g.setSize(window.innerWidth*.8,window.innerHeight),g.setAnimationLoop(se),document.body.appendChild(g.domElement),window.addEventListener("resize",ie),te(x)}function ee(){const t=new U,e=1e4,s=new Float32Array(e*3),a=new Float32Array(e),n=3e3,i=4e3;for(let o=0;o<e;o++){let c,l,m;c=Math.cbrt(Math.random()*(i**3-n**3)+n**3),l=Math.random()*Math.PI*2,m=Math.acos(2*Math.random()-1);let v=c*Math.sin(m)*Math.cos(l),O=c*Math.sin(m)*Math.sin(l),y=c*Math.cos(m);s[o*3]=v,s[o*3+1]=O,s[o*3+2]=y,a[o]=1.5+Math.random()}t.setAttribute("position",new E(s,3)),t.setAttribute("size",new E(a,1));const d=new G({uniforms:{time:{value:0}},vertexShader:`
        attribute float size;
        uniform float time;
        varying float vOpacity;
        
        void main() {
            vOpacity = 0.6 + 0.4 * sin(time + size * 10.0);
            vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
            gl_PointSize = size * (300.0 / -mvPosition.z);
            gl_Position = projectionMatrix * mvPosition;
        }
    `,fragmentShader:`
        varying float vOpacity;
        void main() {
            gl_FragColor = vec4(1.0, 1.0, 1.0, vOpacity);
        }
    `,transparent:!0});P=new W(t,d),_.add(P),b=new $(1e3),_.add(b)}function te(t){u=new q(t,g.domElement),u.target=new H(0,0,0),u.minDistance=.01,u.maxDistance=2e3,u.zoomSpeed=2,u.rotateSpeed=.3,u.enablePan=!1}function ie(){const t=window.innerWidth*.8/window.innerHeight;x.aspect=t,x.updateProjectionMatrix(),g.setSize(window.innerWidth*.8,window.innerHeight)}async function D(t,e,s,a,n,i){const d=new J(.2*a,32,32);let o;i==null?o=new C().load(o):(console.log(i),o=new C().load((await X[`../images/Textures/Default/${i}.png`]()).default));const c=new K({map:o}),l=new Q(d,c);l.position.set(t*w,s*w,e*w),document.getElementById(n).querySelector("i").addEventListener("click",()=>{x.position.set(l.position.x,l.position.y,l.position.z>0?l.position.z+10:l.position.z-10),u.target=l.position}),L[n]=l,_.add(l)}function se(){u.update(),P.material.uniforms.time.value=performance.now()*.002,ne()}function ne(){g.render(_,x)}function ae(){setInterval(oe,1e3/24)}function R(t){M=M.concat(t)}window.ToggleSim=t=>{A=!A;let e=t.querySelector("i");A?(e.classList.remove("fa-pause"),e.classList.add("fa-play")):(e.classList.remove("fa-play"),e.classList.add("fa-pause"))};window.ToggleAxes=()=>{b.visible=!b.visible};function oe(){if(!A){let t=M[S];for(let e=0;e<t.length;e++)L[t[e].objectId].position.set(t[e].xPos*w/T,t[e].zPos*w/T,t[e].yPos*w/T);S++}S+1e3==M.length&&le()}async function le(){let t=await fetch(`https://localhost:7168/api/Data/GetFrames?sessionId=${z("sessionId").replace(/['"]+/g,"").toUpperCase()}&timescale=3600&num=2000`);R(JSON.parse(await t.text()))}function z(t){let e=t+"=",a=decodeURIComponent(document.cookie).split(";");for(let n=0;n<a.length;n++){let i=a[n];for(;i.charAt(0)==" ";)i=i.substring(1);if(i.indexOf(e)==0)return i.substring(e.length,i.length)}return""}const r=[{id:1,name:"The Sun",type:"star",mass:1,radius:1,satellites:[{object:{id:2,name:"Mercury",type:"planet",mass:.055,radius:.382},orbit:{smAxis:.387098,eccentricity:.20563,inclination:7.005,longOfAscNode:48.331,argOfPeri:29.124}},{object:{id:3,name:"Venus",type:"planet",mass:.815,radius:.95},orbit:{smAxis:.723332,eccentricity:.006772,inclination:3.395,longOfAscNode:76.68,argOfPeri:54.884}},{object:{id:4,name:"Earth",type:"planet",mass:1,radius:1},orbit:{smAxis:1,eccentricity:.0167086,inclination:.005,longOfAscNode:174.873,argOfPeri:288.064}},{object:{id:5,name:"Mars",type:"planet",mass:.107,radius:.532},orbit:{smAxis:1.52368055,eccentricity:.0934,inclination:1.85,longOfAscNode:49.57854,argOfPeri:286.5}},{object:{id:6,name:"Jupiter",type:"planet",mass:317.8,radius:11},orbit:{smAxis:5.2038,eccentricity:.0489,inclination:1.303,longOfAscNode:100.464,argOfPeri:273.867}},{object:{id:7,name:"Saturn",type:"planet",mass:95.159,radius:9},orbit:{smAxis:9.5826,eccentricity:.0565,inclination:2.485,longOfAscNode:113.665,argOfPeri:339.392}},{object:{id:8,name:"Uranus",type:"planet",mass:14.536,radius:4},orbit:{smAxis:19.19126,eccentricity:.04717,inclination:.773,longOfAscNode:74.006,argOfPeri:96.998857}},{object:{id:9,name:"Neptune",type:"planet",mass:17.147,radius:3.85},orbit:{smAxis:30.07,eccentricity:.008678,inclination:1.77,longOfAscNode:131.783,argOfPeri:273.187}}]}];let I=[];const re=667408e-16,f=149597870700,ce=1.9884*10**30,de=5.972*10**24;var V;class h{constructor(e,s,a){this.x=e,this.y=s,this.z=a}rotate(e,s){let a=Math.cos(s),n=Math.sin(s),i=1-a,d=this.x*a+this.x*e.x*e.x*i+this.y*e.x*e.y*i-this.y*e.z*n+this.z*e.y*n+this.z*e.x*e.z*i,o=this.x*e.z*n+this.x*e.x*e.y*i+this.y*a+this.y*e.y*e.y*i+-1*this.z*e.x*n+this.z*e.y*e.z*i,c=-1*this.x*e.y*n+this.x*e.x*e.z*i+this.y*e.x*n+this.y*e.y*e.z*i+this.z*a+this.z*e.z*e.z*i;this.x=d,this.y=o,this.z=c}multiply(e){this.x*=e,this.y*=e,this.z*=e}}document.addEventListener("DOMContentLoaded",()=>{z("sessionId"),Y(),me()});window.addEventListener("beforeunload",()=>{fetch(`https://localhost:7168/api/Data/DeleteSimulation?sessionId=${z("sessionId").replace(/['"]+/g,"").toUpperCase()}`,{method:"POST",headers:{"Content-Type":"application/json"}})});function me(){const t=r.length;for(let e=0;e<t;e++){let s={CelestialObject:{id:r[e].id,name:r[e].name,type:r[e].type,mass:r[e].mass,radius:r[e].radius},telemetry:{position:{x:0,y:0,z:0},velocity:{x:0,y:0,z:0}}};const a=r[e].satellites.length;j(r[e]),D(s.telemetry.position.x/f,s.telemetry.position.y/f,s.telemetry.position.z/f,s.CelestialObject.radius*10,s.CelestialObject.id,s.CelestialObject.name),I.push(s);for(let n=0;n<a;n++){let i={CelestialObject:{id:r[e].satellites[n].object.id,name:r[e].satellites[n].object.name,type:r[e].satellites[n].object.type,mass:r[e].satellites[n].object.mass,radius:r[e].satellites[n].object.radius},telemetry:{position:{x:0,y:0,z:0},velocity:{x:0,y:0,z:0}}};ue(s,i,r[e].satellites[n].orbit),j(r[e].satellites[n].object),D(i.telemetry.position.x/f,i.telemetry.position.y/f,i.telemetry.position.z/f,i.CelestialObject.radius,i.CelestialObject.id,i.CelestialObject.name),I.push(i)}}ye()}function j(t){const e=document.getElementById("card-container"),a=document.getElementById("info-card-template").content.cloneNode(!0);a.querySelector("span").innerText=t.name,a.querySelector("div").id=t.id,e.appendChild(a)}function pe(t,e,s){let a=e-t*e;return Math.sqrt(re*s*(2/a-1/e))}function ue(t,e,s){const a=(s.smAxis-s.eccentricity*s.smAxis)*f,n=new h(a,0,0),i=new h(t.telemetry.position.x,t.telemetry.position.y,t.telemetry.position.z),d=s.longOfAscNode*Math.PI/180,o=s.inclination*Math.PI/180,c=s.argOfPeri*Math.PI/180,l=Math.cos(o),m=Math.sin(o),v=Math.cos(d),O=Math.sin(d);n.rotate(new h(0,0,1),d),n.rotate(new h(O,-1*v,0),o),n.rotate(new h(-1*m*v,-1*m*O,l),c),e.telemetry.position.x=i.x+n.x,e.telemetry.position.y=i.y+n.y,e.telemetry.position.z=i.z+n.z;let y=new h(0,1,0);y.rotate(new h(0,0,1),d),y.rotate(new h(-1*m*v,-1*m*O,l),c),y.multiply(pe(s.eccentricity,s.smAxis*f,t.CelestialObject.mass*(t.CelestialObject.type=="planet"?de:ce))),e.telemetry.velocity.x=y.x,e.telemetry.velocity.y=y.y,e.telemetry.velocity.z=y.z}async function ye(){let t={};t.Objects=I,t.SessionId=z("sessionId").replace(/['"]+/g,"").toUpperCase(),t.Timescale=3600;let e;he(),await fetch("https://localhost:7168/api/Data/StartSimulation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(async()=>{e=await fetch(`https://localhost:7168/api/Data/GetFrames?sessionId=${z("sessionId").replace(/['"]+/g,"").toUpperCase()}&timescale=3600&num=2000`),fe()}),R(JSON.parse(await e.text())),ae()}function he(){const t=document.getElementById("loading-text");V=setInterval(()=>{t.innerText.length>9?t.innerText="Loading":t.innerText+="."},1e3)}function fe(){clearInterval(V);const t=document.getElementById("loading-text");t.innerText="Ready!"}
